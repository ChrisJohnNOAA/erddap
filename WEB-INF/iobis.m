% Example script to get data from www.iobis.org into Matlab.% Bob Simons (bob.simons@noaa.gov)% Last modified 2007-05-17b% (Adapted from caron.m from Rich Signell  rsignell@usgs.gov )%% Copyright 2007, NOAA.% Permission to use, copy, modify, and distribute this software and% its documentation for any purpose and without fee is hereby granted,% provided that the above copyright notice appear in all copies, that% both the copyright notice and this permission notice appear in% supporting documentation, and that redistributions of modified forms% of the source or binary code carry prominent notices stating that the% original code was changed and the date of the change.  This software% is provided "as is" without express or implied warranty.% % DISCLAIMER OF LIABILITY% THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR % IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, % FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE % AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER % LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, % OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE % SOFTWARE.% Download and install the ErdJava.zip file from: %   For now (in development), use: http://coastwatch.pfel.noaa.gov/cwexperimental/NetCheck.html/%   When officially released: http://coastwatch.pfel.noaa.gov/coastwatch/NetCheck.html/% For the following examples, I'll assume the ErdJava.zip file is unzipped %   into /Applications/ErdJava.% For Matlab 7+:javaaddpath('/Applications/ErdJava/lib/commons-codec-1.3.jar','-end');javaaddpath('/Applications/ErdJava/lib/commons-httpclient-3.0.1.jar','-end');javaaddpath('/Applications/ErdJava/lib/commons-logging-1.1.jar','-end');javaaddpath('/Applications/ErdJava/lib/netcdf-latest.jar','-end');javaaddpath('/Applications/ErdJava/lib/slf4j-jdk14.jar','-end');javaaddpath('/Applications/ErdJava/classes','-end');% For Matlab 6 or 6.5:%  1. "edit classpath.txt" and add the following lines to the list%     /Applications/ErdJava/lib/commons-codec-1.3.jar%     /Applications/ErdJava/lib/commons-httpclient-3.0.1.jar%     /Applications/ErdJava/lib/commons-logging-1.1.jar%     /Applications/ErdJava/lib/netcdf-latest.jar%     /Applications/ErdJava/lib/slf4j-jdk14.jar%     /Applications/ErdJava/classes%  2.  Restart Matlab% NOTE: For all versions of Matlab, edit "classpath.txt" and remove % (or comment) the line that contains%  "mwucarunits.jar" and restart MATLAB.  The "mwucarunits.jar" file is only% used by the Mathworks "Model-Based Calibration Toolbox" and contains an % old implementation of the Unidata udunits package that conflicts with% the more recent version that NetCDF-Java uses.% import the classes and methods we need for this exampleimport gov.noaa.pfel.coastwatch.pointdata.Table% create a Table objecttable = Table();% read the data into the table via%    table.readIobis(String url, String genus, String species, %        String west, String east, String south, String north,%        String minDepth, String maxDepth,%        String startDate, String endDate, %        String loadColumns[])   % Leave parameters blank to not limit the search in that way.% @param url currently, the only known valid url is Table.IOBIS_URL% @param genus  case sensitive, use '' for no preference % @param species case sensitive, use '' for no preference% @param west the west boundary specified in degrees east, -180 to 180; %     use '' for no preference; west must be <= east.% @param east the east boundary specified in degrees east, -180 to 180; %     use '' for no preference; % @param south the south boundary specified in degrees north; %     use '' for no preference; south must be <= north.% @param north the north boundary specified in degrees north; %     use '' for no preference;  % @param minDepth in meters; use '' for no preference; %     positive equals down;%     minDepth must be <= maxDepth.%     Depth has few values, so generally good not to specify minDepth or maxDepth.% @param maxDepth in meters; use '' for no preference; % @param startDate an ISO date string (optional time, space or T connected);%     use '' for no preference; startDate must be <= endDate.%     The time part of the string is used.% @param endDate % @param loadColumns are the data columns to be downloaded from DiGir.  %   The first 5 columns in the results table are automatically LON, LAT, %     DEPTH (from darwin:MinimumDepth), %     TIME stored as seconds since 1970-01-01 00:00:00 (created from the %       darwin:YearCollected, darwin:MonthCollected, darwin:DayCollected, %       and darwin:TimeOfDay variables), %     and ID created from <darwin:InstitutionCode>:<darwin:CollectionCode>:<darwin:CatalogNumber>.%   loadColumns lets you specify the subsequent columns.%   Or use null (how??) to load all columns.%   The available columns are: Res_name|Scientificname|Institutioncode|%     Catalognumber|Latitude|Longitude|Collectioncode|Datelastmodified|%     Basisofrecord|Yearcollected|Monthcollected|Daycollected|Genus|%     Minimumdepth|Maximumdepth|Species|Class|Kingdom|Ordername|Phylum|%     Family|Citation|Source|Scientificnameauthor|Recordurl|Slatitude|%     Collector|Locality|Starttimecollected|Timeofday|Country|Startyearcollected|%     Fieldnumber|Startmonthcollected|Startdaycollected|Slongitude|Notes|%     Endtimecollected|Ocean|Timezone|Julianday|Startjulianday|Observedindividualcount|%     Individualcount|State|Coordinateprecision|Endyearcollected|Endmonthcollected|%     Enddaycollected|County|Observedweight|Elatitude|Elongitude|Collectornumber|%     Temperature|Identifiedby|Lifestage|Depthrange|Preparationtype|Subspecies|%     Yearidentified|Monthidentified|Dayidentified|Typestatus|Sex|Subgenus|%     Seprecision|Endjulianday|Relatedcatalogitem|Relationshiptype|%     Previouscatalognumber|Starttimeofday|Endtimeofday|Samplesize.table.readIobis(Table.IOBIS_URL, 'Macrocystis', '', '-180', '180', '53', '54', '', '', '1970-01-01', '', {'Temperature', 'Scientificname'});% copy data into Matlab arrays lon=squeeze(table.findColumn('LON').toArray());lat=squeeze(table.findColumn('LAT').toArray());depth=squeeze(table.findColumn('DEPTH').toArray());time=squeeze(table.findColumn('TIME').toArray());temperature=squeeze(table.findColumn('Temperature').toArray());sciname=squeeze(table.findColumn('Scientificname').toArray());% plot the data with scatter(x,y,size,color)scatter(lon, lat, 50, time)% set the titletitle('Macrocystis Locations')% end-of-file